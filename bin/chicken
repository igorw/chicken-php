#!/usr/bin/env php
<?php

require __DIR__.'/../vendor/autoload.php';

use igorw\chicken;

$code = stream_get_contents(STDIN);
$input = isset($argv[1]) ? $argv[1] : '';
$logger = getenv('CHICKEN_LOG') ? new Monolog\Logger('chicken') : null;

$opcodes = chicken\compile($code);
echo chicken\execute($opcodes, $input, $logger)."\n";
